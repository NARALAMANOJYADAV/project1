<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MARVELL RESTUARENT</title>
  <style>
    /* General Styles */
body {
    font-family: 'Arial', sans-serif;
    background-color: #f8f9fa;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    background-image: url('https://png.pngtree.com/background/20230528/original/pngtree-food-spread-on-the-table-picture-image_2782704.jpg');
    background-size: cover;
    background-position: center;
    background-repeat: no-repeat;
  }
  
  .container {
    width: 90%;
    max-width: 1200px;
    background: #fff;
    padding: 70px;
    border-radius: 30px;
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
  }
  
  h2 {
    font-size: 68px;
    margin-bottom: 30px;
    color: #333;
    text-align: center;
  }
  
  h3 {
    font-size: 48px;
    margin-bottom: 25px;
    color: #333;
  }
  
  p {
    font-size: 38px;
    color: #666;
    margin-bottom: 30px;
    text-align: center;
  }
  
  /* Form Steps */
  .form-step {
    display: none;
    opacity: 0;
    transition: opacity 0.5s ease-in-out, transform 0.5s ease-in-out;
    transform: translateX(100%);
  }
  
  
  .form-step.active {
    display: block;
    opacity: 1;
    transform: translateX(0);
  }
  
  /* Form Groups */
  .form-group {
    margin-bottom: 60px;
    width: 95%;
  }
  
  label {
    display: block;
    font-size: 42px;
    color: #333;
    margin-bottom: 25px;
  }
  
  input,
  textarea,
  select {
    width: 100%;
    padding: 35px;
    border: 3px solid #ddd;
    border-radius: 15px;
    font-size: 38px;
    color: #333;
    background-color: #f9f9f9;
    transition: border-color 0.3s ease;
  }
  
  input:focus,
  textarea:focus,
  select:focus {
    border-color: #3498db;
    outline: none;
    background-color: #fff;
  }
  
  textarea {
    resize: vertical;
    min-height: 200px;
  }
  
  /* Buttons */
  button {
    padding: 25px 50px;
    border: none;
    border-radius: 15px;
    font-size: 32px;
    cursor: pointer;
    transition: background 0.3s ease, transform 0.2s ease;
    margin: 15px 10px;
  }
  
  .paymentDetails {
    width: 95%;
    margin-top: 30px;
    padding: 30px;
    background-color: #f8f9fa;
    border-radius: 20px;
  }
  
  .btn-primary {
    background: #28a745;
    color: #fff;
  }
  
  .btn-primary:hover {
    background: #218838;
    transform: scale(1.05);
  }
  
  .btn-secondary {
    background: #f8f9fa;
    color: #333;
    border: 3px solid #ddd;
    margin-right: 20px;
    font-size: 28px;
  }
  
  .btn-secondary:hover {
    background: #e9ecef;
    transform: scale(1.05);
  }
  
  /* Options Section */
  .options,
  .categories {
    display: flex;
    justify-content: space-around;
    margin-top: 40px;
    flex-wrap: wrap;
    gap: 30px;
  }
  
  .option,
  .category {
    text-align: center;
    cursor: pointer;
    padding: 40px;
    border: 3px solid #ddd;
    border-radius: 20px;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
    flex: 1;
    min-width: 300px;
    background: #fff;
  }
  
  .option:hover,
  .category:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
  }
  
  .option img {
    width: 250px;
    height: 250px;
    border-radius: 20px;
    margin-bottom: 25px;
    object-fit: cover;
  }
  
  .option p,
  .category p {
    font-size: 32px;
    color: #333;
    margin: 0;
  }
  
  /* Restaurants and Menu */
  .restaurants,
  .slideshow {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 40px;
    margin-top: 40px;
  }
  
  .restaurant,
  .menu-item {
    background: #f8f9fa;
    padding: 40px;
    border-radius: 20px;
    text-align: center;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  
  .restaurant:hover,
  .menu-item:hover {
    transform: translateY(-5px);
    box-shadow: 0 8px 30px rgba(0, 0, 0, 0.2);
  }
  
  .restaurant img,
  .menu-item img {
    width: 100%;
    height: 250px;
    object-fit: cover;
    border-radius: 20px;
    margin-bottom: 25px;
  }
  
  .restaurant p,
  .menu-item p {
    font-size: 32px;
    color: #333;
    margin: 15px 0;
  }
  
  /* Buzzwords */
  .buzzwords {
    display: flex;
    gap: 20px;
    margin-top: 40px;
    justify-content: center;
    flex-wrap: wrap;
  }
  
  .buzzwords button {
    padding: 20px 40px;
    font-size: 28px;
  }
  
  /* Order Summary */
  #orderSummary {
    margin-top: 40px;
    text-align: center;
    padding: 40px;
    background-color: #f8f9fa;
    border-radius: 20px;
  }
  
  #orderSummary p {
    font-size: 32px;
    color: #333;
    margin-bottom: 20px;
    text-align: left;
  }
  
  #orderSummary ul {
    text-align: left;
    padding-left: 40px;
    font-size: 32px;
  }
  /* Add this to your CSS */
.btn-secondary {
  background: #f8f9fa;
  color: #333;
  border: 3px solid #ddd;
  margin-right: 20px;
  font-size: 32px; /* Match other buttons */
  padding: 25px 50px; /* Match other buttons */
}

.btn-secondary:hover {
  background: #e9ecef;
  transform: scale(1.05);
}
  /* Menu item button */
  .menu-item button {
    padding: 20px 40px;
    font-size: 28px;
    margin-top: 20px;
  }
  
  /* Loading spinner */
  .spinner {
    display: none;
    width: 70px;
    height: 70px;
    margin: 30px auto;
    border: 10px solid #f3f3f3;
    border-top: 10px solid #3498db;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  
  @keyframes spin {
    0% { transform: rotate(0deg); }
    100% { transform: rotate(360deg); }
  }
  
  /* Button container */
  .button-container {
    display: flex;
    justify-content: center;
    margin-top: 40px;
  }
  
  /* Alert messages */
  .alert {
    padding: 20px;
    margin: 20px 0;
    border-radius: 10px;
    font-size: 32px;
  }
  
  .alert-success {
    background-color: #d4edda;
    color: #155724;
    border: 2px solid #c3e6cb;
  }
  
  .alert-warning {
    background-color: #fff3cd;
    color: #856404;
    border: 2px solid #ffeeba;
  }
  
  /* Order Details Modal */
  .modal {
    display: none;
    position: fixed;
    z-index: 100;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.4);
  }
  
  .modal-content {
    background-color: #fefefe;
    margin: 10% auto;
    padding: 40px;
    border-radius: 20px;
    width: 80%;
    max-width: 800px;
    box-shadow: 0 8px 30px rgba(0,0,0,0.3);
  }
  
  .close-modal {
    color: #aaa;
    float: right;
    font-size: 48px;
    font-weight: bold;
    cursor: pointer;
  }
  
  .close-modal:hover {
    color: black;
  }
  
  .order-details {
    font-size: 32px;
    line-height: 1.6;
  }
  
  .order-details h3 {
    margin-top: 0;
  }
  
  .order-details ul {
    padding-left: 40px;
  }
  
  .order-details li {
    margin-bottom: 15px;
  }
  
  .email-notice {
    background-color: #e7f3fe;
    border-left: 6px solid #2196F3;
    padding: 20px;
    margin: 20px 0;
    font-size: 28px;
  }
  
  /* Table Number Page */
  .table-number-page {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: #f8f9fa;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    z-index: 1000;
  }
  
  .table-number-page h1 {
    font-size: 3vh;
    margin-bottom: 20px;
  }
  
  .table-number-page input {
    padding: 15px;
    font-size: 3vh;
    margin: 15px 0;
    width: 250px;
    border: 1px solid #ddd;
    border-radius: 5px;
  }
  
  .table-number-page button {
    padding: 15px 30px;
    font-size: 3vh;
    background-color: #28a745;
    color: white;
    border: none;
    cursor: pointer;
    border-radius: 5px;
  }
  
  /* Cart Modal */
  .cart-view {
    position: fixed;
    right: 20px;
    top: 20px;
    background: #fff;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 4px 15px rgba(0,0,0,0.2);
    cursor: pointer;
  }
  
  .cart-modal {
    display: none;
    position: fixed;
    z-index: 101;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.4);
  }
  
  .cart-modal-content {
    background-color: #fff;
    margin: 15% auto;
    padding: 20px;
    border-radius: 10px;
    width: 80%;
    max-width: 500px;
  }
  
  .success-message {
    background-color: #d4edda;
    color: #155724;
    padding: 20px;
    border-radius: 10px;
    margin: 20px 0;
    text-align: center;
  }
  
  /* Responsive adjustments */
  @media (max-width: 768px) {
    .container {
      padding: 40px;
    }
    
    h2 {
      font-size: 48px;
    }
    
    .options, .categories {
      flex-direction: column;
      align-items: center;
    }
    
    .option, .category {
      width: 80%;
    }
    
    .restaurants, .slideshow {
      grid-template-columns: 1fr;
    }
    
    .modal-content {
      width: 90%;
      padding: 20px;
    }
  }
  
  </style>
  <!-- Add EmailJS library -->
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
  <script type="text/javascript">
    // Initialize EmailJS with your public key
    (function() {
      emailjs.init('yt3uhvbk3jgCdDpsv');
    })();
  </script>
</head>
<body>
  <div id="tableNumberPage" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: #f8f9fa; display: flex; flex-direction: column; justify-content: center; align-items: center; z-index: 1000;">
    <h1 style="font-size:3vh; margin-bottom: 20px;">Welcome! Please Enter Your Table Number</h1>
    <input type="number" id="tableInput" placeholder="Enter table number" min="1" max="20" style="padding: 15px; font-size:3vh; margin: 15px 0; width: 250px; border: 1px solid #ddd; border-radius: 5px;">
    <button onclick="submitTable()" style="padding: 15px 30px; font-size:3vh; background-color: #28a745; color: white; border: none; cursor: pointer; border-radius: 5px;">Submit</button>
  </div>

  <div class="container">
    <!-- Step 1: Login Page -->
    <div id="step1" class="form-step active">
      <h2>Welcome to Mar-Vell Restaurant</h2>
      <p>Please enter your details to proceed.</p>
      <form id="loginForm">
        <div class="form-group">
          <label for="name">Name:</label>
          <input type="text" id="name" placeholder="Enter your name" required>
        </div>
        <div class="form-group">
          <label for="email">Email:</label>
          <input type="email" id="email" placeholder="Enter your email" required>
        </div>
        <div class="form-group">
          <label for="phone">Phone:</label>
          <input type="tel" id="phone" placeholder="Enter your phone number" required>
        </div>
        <div class="button-container">
          <button type="button" class="btn-primary" onclick="validateStep1()">Submit</button>
        </div>
      </form>
    </div>

    <!-- Step 2: Veg/Non-Veg Selection -->
    <div id="step2" class="form-step">
      <h2>Choose Your Preference</h2>
      <p>Select your food preference to proceed.</p>
      <div class="options">
        <div class="option" onclick="selectPreference('veg')">
          <img src="https://tse1.mm.bing.net/th?id=OIP.aE3mmRnS1fF1W3nbpLNABwHaHa&pid=Api&P=0&h=180" alt="Veg">
          <p>Veg</p>
        </div>
        <div class="option" onclick="selectPreference('nonVeg')">
          <img src="https://tse1.mm.bing.net/th?id=OIP.SixAhBYVY0w44E74IWLbjAHaEK&pid=Api&P=0&h=180" alt="Non-Veg">
          <p>Non-Veg</p>
        </div>
      </div>
      <div class="button-container">
        <button type="button" class="btn-secondary" onclick="prevStep()">Back</button>
      </div>
    </div>

    <!-- Step 3: Category Selection (Breakfast, Lunch, Snacks, Dinner) -->
    <div id="step3" class="form-step">
      <h2>Choose a Meal Schedule</h2>
      <p>Select a Meal Schedule to explore restaurants.</p>
      <div id="categoryList" class="categories"></div>
      <div class="button-container">
        <button type="button" class="btn-secondary" onclick="prevStep()">Back</button>
      </div>
    </div>

    <!-- Step 4: Restaurant Selection -->
    <div id="step4" class="form-step">
      <h2>Choose a Category</h2>
      <p>Select a Category from the list below.</p>
      <div id="restaurantList" class="restaurants"></div>
      <div class="button-container">
        <button type="button" class="btn-secondary" onclick="prevStep()">Back</button>
      </div>
    </div>

    <!-- Step 5: Menu Display -->
    <div id="step5" class="form-step">
      <h2>Menu</h2>
      <p>Select items from the menu.</p>
      
      <div id="menuSlideshow" class="slideshow"></div>
      <div class="button-container">
        <button type="button" class="btn-secondary" onclick="prevStep()">Back</button>
        <button type="button" class="btn-primary" onclick="nextStep(6)">Next</button>
        <!-- Add this inside step5 div, after the <p> tag -->
          <button class="btn-primary" onclick="showCart()" style="font-size: 28px; padding: 15px 30px;">
            View Cart (<span id="cartCount">0</span>)
          </button>
      </div>
    </div>

    <!-- Step 6: Food Requirements -->
    <div id="step6" class="form-step">
      <h2>Food Requirements</h2>
      <p>Add any special instructions for your order.</p>
      <textarea id="specifications" placeholder="Add any special instructions..."></textarea>
      <div class="buzzwords">
        <button class="btn-secondary" onclick="addRequirement('Less Spicy')">Less Spicy</button>
        <button class="btn-secondary" onclick="addRequirement('Extra Cheese')">Extra Cheese</button>
        <button class="btn-secondary" onclick="addRequirement('Extra veggies')">Extra veggies</button>
        <button class="btn-secondary" onclick="addRequirement('Low oil')">Low oil</button>
        <button class="btn-secondary" onclick="addRequirement('More spicy')">More spicy</button>
        <button class="btn-secondary" onclick="addRequirement('Medium spicy')">Medium Spicy</button>
      </div>
      <div class="button-container">
        <button type="button" class="btn-secondary" onclick="prevStep()">Back</button>
        <button type="button" class="btn-primary" onclick="nextStep(7)">Next</button>
      </div>
    </div>

    <!-- Step 7: Payment Options -->
    <div id="step7" class="form-step">
      <div class="form-group">
        <label for="payment">Payment Method:</label>
        <select id="payment" name="payment" required onchange="togglePaymentFields()">
          <option value="">Select Payment Method</option>
          <option value="creditCard">Credit Card</option>
          <option value="debitCard">Debit Card</option>
          <option value="googlePay">Google Pay</option>
          <option value="paytm">Paytm</option>
          <option value="phonePe">PhonePe</option>
          <option value="scanner">Scanner</option>
          <option value="netBanking">Net Banking</option>
          <option value="upiId">UPI ID</option>
        </select>
      </div>
      
      <!-- Payment details sections (same as before) -->
      <div id="creditCardDetails" class="paymentDetails" style="display:none;">
        <h3>Credit Card Payment</h3>
        <div class="form-group">
          <label for="cardNumber">Card Number:</label>
          <input type="text" id="cardNumber" name="cardNumber" placeholder="1234 5678 9012 3456">
        </div>
        <div class="form-group">
          <label for="expiry">Expiry Date:</label>
          <input type="text" id="expiry" name="expiry" placeholder="MM/YY">
        </div>
        <div class="form-group">
          <label for="cvv">CVV:</label>
          <input type="text" id="cvv" name="cvv" placeholder="123">
        </div>
      </div>

      <!-- Debit Card Payment Fields -->
      <div id="debitCardDetails" class="paymentDetails" style="display:none;">
        <h3>Debit Card Payment</h3>
        <div class="form-group">
          <label for="debitCardNumber">Debit Card Number:</label>
          <input type="text" id="debitCardNumber" name="debitCardNumber" placeholder="1234 5678 9012 3456">
        </div>
        <div class="form-group">
          <label for="debitExpiry">Expiry Date:</label>
          <input type="text" id="debitExpiry" name="debitExpiry" placeholder="MM/YY">
        </div>
        <div class="form-group">
          <label for="debitCvv">CVV:</label>
          <input type="text" id="debitCvv" name="debitCvv" placeholder="123">
        </div>
      </div>

      <!-- Google Pay Payment Fields -->
      <div id="googlePayDetails" class="paymentDetails" style="display:none;">
        <h3>Google Pay Payment</h3>
        <div class="form-group">
          <label for="googlePayPhoneNumber">Google Pay Phone Number:</label>
          <input type="text" id="googlePayPhoneNumber" name="googlePayPhoneNumber" placeholder="Enter your phone number">
        </div>
      </div>

      <!-- Paytm Payment Fields -->
      <div id="paytmDetails" class="paymentDetails" style="display:none;">
        <h3>Paytm Payment</h3>
        <div class="form-group">
          <label for="paytmMobile">Paytm Mobile Number:</label>
          <input type="text" id="paytmMobile" name="paytmMobile" placeholder="Enter your phone number">
        </div>
      </div>

      <!-- PhonePe Payment Fields -->
      <div id="phonePeDetails" class="paymentDetails" style="display:none;">
        <h3>PhonePe Payment</h3>
        <div class="form-group">
          <label for="phonePeMobile">PhonePe Mobile Number:</label>
          <input type="text" id="phonePeMobile" name="phonePeMobile" placeholder="Enter your phone number">
        </div>
      </div>

      <!-- Scanner Payment Fields -->
      <div id="scannerDetails" class="paymentDetails" style="display:none;">
        <h3>Scanner Payment</h3>
        <p>Please scan the QR code below:</p>
        <img src="https://upload.wikimedia.org/wikipedia/commons/thumb/d/d0/QR_code_for_mobile_English_Wikipedia.svg/1200px-QR_code_for_mobile_English_Wikipedia.svg.png" alt="QR Code" style="max-width: 300px; margin: 0 auto; display: block;">
      </div>

      <!-- Net Banking Fields -->
      <div id="netBankingDetails" class="paymentDetails" style="display:none;">
        <h3>Net Banking Payment</h3>
        <div class="form-group">
          <label for="bankName">Bank Name:</label>
          <input type="text" id="bankName" name="bankName" placeholder="Enter bank name">
        </div>
        <div class="form-group">
          <label for="accountNumber">Account Number:</label>
          <input type="text" id="accountNumber" name="accountNumber" placeholder="Enter account number">
        </div>
        <div class="form-group">
          <label for="ifscCode">IFSC Code:</label>
          <input type="text" id="ifscCode" name="ifscCode" placeholder="Enter IFSC code">
        </div>
        <div class="form-group">
          <label for="branchName">Branch Name:</label>
          <input type="text" id="branchName" name="branchName" placeholder="Enter branch name">
        </div>
      </div>

      <!-- UPI ID Fields -->
      <div id="upiIdDetails" class="paymentDetails" style="display:none;">
        <h3>UPI ID Payment</h3>
        <div class="form-group">
          <label for="upiId">UPI ID:</label>
          <input type="text" id="upiId" name="upiId" placeholder="Enter UPI ID">
        </div>
      </div>
      <!-- ... -->
      
      <div id="spinner" class="spinner"></div>
      <div class="button-container">
        <button type="button" class="btn-secondary" onclick="prevStep()">Back</button>
        <button type="button" class="btn-primary" onclick="processPayment()">Submit Payment</button>
      </div>
    </div>

    <!-- Step 8: Order Summary -->
    <div id="step8" class="form-step">
      <h2>Order Summary</h2>
      <div id="orderSummary"></div>
      <div class="button-container">
        <button type="button" class="btn-primary" onclick="showOrderDetails()">View Order Details</button>
        <button type="button" class="btn-primary" onclick="restartOrder()">Place New Order</button>
        <button type="button" class="btn-primary" onclick="sendOrderToAdmin()">Submit Order</button>
        <button type="button" class="btn-secondary" onclick="closeTab()">Exit</button>
      </div>
    </div>
  </div>

  <!-- Cart Modal -->
  <!-- Replace the existing cart modal with this -->
<div id="cartModal" class="cart-modal" style="display: none; position: fixed; z-index: 1001; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4);">
  <div class="cart-modal-content" style="background-color: #fefefe; margin: 15% auto; padding: 20px; border: 1px solid #888; width: 80%; max-width: 500px; border-radius: 10px;">
    <span class="close-modal" onclick="closeCart()" style="color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer;">&times;</span>
    <h3>Your Cart</h3>
    <div id="cartItems"></div>
    <p>Total: ₹<span id="cartTotal">0</span></p>
    <div style="display: flex; justify-content: space-between; margin-top: 20px;">
      <button class="btn-secondary" onclick="closeCart()">Continue Shopping</button>
      <button class="btn-primary" onclick="proceedToCheckout()">Proceed to Checkout</button>
    </div>
  </div>
</div>
  <!-- Order Details Modal -->
  <div id="orderDetailsModal" class="modal">
    <div class="modal-content">
      <span class="close-modal" onclick="closeModal()">&times;</span>
      <div id="modalOrderDetails" class="order-details"></div>
    </div>
  </div>
  <script>
    // Initialize EmailJS with your public key
(function() {
    emailjs.init('yt3uhvbk3jgCdDpsv');
  })();
  
  // Global variables
  let currentStep = 1;
  let userPreference = '';
  let selectedCategory = '';
  let selectedRestaurant = null;
  let cart = [];
  let requirements = [];
  let userName = '';
  let userEmail = '';
  let userPhone = '';
  let tableNumber = '';
  let paymentCompleted = true;
  
  // Restaurant data
  const restaurants = {
    "veg": {
        "breakfast": [
          { "name": "Idly", "price": 150, "image": "https://tse1.mm.bing.net/th?id=OIP.OrTVxjF7_Pa20Y9oTH6tQgHaEo&pid=Api&P=0&h=180" },
          { "name": "Masala Dosa", "price": 40, "image": "https://img.freepik.com/premium-photo/masala-dosa-is-south-indian-meal-served-with-sambhar-coconut-chutney-selective-focus_466689-22958.jpg?w=2000" },
          { "name": "Vada", "price": 40, "image": "https://img.freepik.com/premium-photo/sambar-vada-medu-vada-popular-south-indian-food-served-with-green-red-coconut-chutney-moody-background-selective-focus_466689-59611.jpg?w=2000" },
          { "name": "Pongal", "price": 100, "image": "https://3.bp.blogspot.com/-k7wuR5PQvOM/UTaOvEurMII/AAAAAAAACC8/J19E-xuelV0/w1200-h630-p-k-no-nu/IMG_7109.JPG" },
          { "name": "Poori", "price": 45, "image": "https://tse4.mm.bing.net/th?id=OIP.98EL-or-Hio0D7NKuo7hHgHaE8&pid=Api&P=0&h=180" },
          { "name": "Upma", "price": 80, "image": "https://tse4.mm.bing.net/th?id=OIP.boBBw90ShLIHl5l9pQvbQgHaE7&pid=Api&P=0&h=180" },
          { "name": "Cheese Dosa", "price": 90, "image": "https://www.indianhealthyrecipes.com/wp-content/uploads/2016/09/cheese-dosai-recipe-600x400.jpg" },
          { "name": "Chapathi", "price": 80, "image": "https://tse1.mm.bing.net/th?id=OIP.qtfvFfAscARBoSPgj6IKXwHaE7&pid=Api&P=0&h=180" },
          { "name": "Pesarattu", "price": 80, "image": "https://tse3.mm.bing.net/th?id=OIP.vRhmrqCavzx_BgNJ7Zh8UgHaGM&pid=Api&P=0&h=180" }
        ],
        "lunch": [
          { "name": "Veg Biryani", "price": 180, "image": "https://tse1.mm.bing.net/th?id=OIP.4wrRVc6j3A9vtrOafulXigHaFM&pid=Api&P=0&h=180" },
          { "name": "Palak Paneer", "price": 175, "image": "https://recipes.timesofindia.com/photo/53093667.cms" },
          { "name": "Kadai Paneer", "price": 200, "image": "https://tse4.mm.bing.net/th?id=OIP.FXqSV1UDRXud3U1fMBPmLAHaHa&pid=Api&P=0&h=180" },
          { "name": "Veg Thali", "price": 290, "image": "https://img.freepik.com/premium-photo/veg-thali-from-indian-cuisine-food-platter-consists-variety-veggiespaneer-dish-lentilsriceroti-sweet-dish-snacks-etc-selective-focus_726363-592.jpg?w=2000" },
          { "name": "Paneer Butter Masala", "price": 150, "image": "https://tse1.mm.bing.net/th?id=OIP.nR-p2bO_B6UkT4h94zaWuQHaHa&pid=Api&P=0&h=180" },
          { "name": "Jeera Rice", "price": 90, "image": "https://tse2.mm.bing.net/th?id=OIP.x-yfYD12QTnsh2GpIdKWPgHaHa&pid=Api&P=0&h=180" },
          { "name": "Roti", "price": 10, "image": "https://tse3.mm.bing.net/th?id=OIP.6CQuC0Koi5HdF_-Thny55AHaHa&pid=Api&P=0&h=180" },
          { "name": "Mushroom Biryani", "price": 200, "image": "https://tse4.mm.bing.net/th?id=OIP.CV4dgf6pCiupeftMqEXUMwHaEK&pid=Api&P=0&h=180" },
          { "name": "Gobi Manchurian", "price": 90, "image": "https://tse3.mm.bing.net/th?id=OIP.5PvO_615yFhu96cQuu9irwHaGM&pid=Api&P=0&h=180" }
        ],
        "snacks": [
          { "name": "Samosa", "price": 30, "image": "https://tse2.mm.bing.net/th?id=OIP.Za740rFsOukbqfwtNMa4FwHaJQ&pid=Api&P=0&h=180" },
          { "name": "Pav Bhaji", "price": 60, "image": "https://tse2.mm.bing.net/th?id=OIP.bjpTLW2E7QMuXzlIe2JsrwHaGs&pid=Api&P=0&h=180" },
          { "name": "Mirchi Bajji", "price": 40, "image": "https://tse1.mm.bing.net/th?id=OIP.gMyg_DLZqtBaRSomY9GtugHaEo&pid=Api&P=0&h=180" },
          { "name": "Veg Rolls", "price": 60, "image": "https://vegecravings.com/wp-content/uploads/2016/09/spring-roll-recipe-step-by-step-instructions.jpg" },
          { "name": "Paneer Puff", "price": 30, "image": "https://tse2.mm.bing.net/th?id=OIP.c39FfLEnVyG6hSYUssBPlgHaJz&pid=Api&P=0&h=180" },
          { "name": "French Fries", "price": 60, "image": "https://tse4.mm.bing.net/th?id=OIP.Jmg8k0E-E_Zy1dSj_tjYjgHaE8&pid=Api&P=0&h=180" },
          { "name": "Red Velvet Cake", "price": 110, "image": "https://tse2.mm.bing.net/th?id=OIP.udBr42Cpf-ZBjzeJEzYGVgHaFr&pid=Api&P=0&h=180" },
          { "name": "Chocolate Truffle", "price": 100, "image": "https://www.tasteofhome.com/wp-content/uploads/2018/01/Chocolate-Truffles_EXPS_HCA17_13122_B10_20_3b.jpg" },
          { "name": "Black Current Icecream", "price": 200, "image": "https://tse2.mm.bing.net/th?id=OIP.I7hY532IzTpQXXxZwprjywHaD4&pid=Api&P=0&h=180" }
        ],
        "dinner": [
          { "name": "Paneer Butter Masala", "price": 150, "image": "https://tse1.mm.bing.net/th?id=OIP.nR-p2bO_B6UkT4h94zaWuQHaHa&pid=Api&P=0&h=180" },
          { "name": "Veg Handi", "price": 100, "image": "https://tse4.mm.bing.net/th?id=OIP.e3jZ6rNEPakpb86q1WZrgQHaEK&pid=Api&P=0&h=180" },
          { "name": "Butter Naan", "price": 220, "image": "https://tse3.mm.bing.net/th?id=OIP.-VoUJjHDnXGlvmrSa2cWxgHaE8&pid=Api&P=0&h=180" },
          { "name": "Garlic Naan", "price": 100, "image": "https://tse4.mm.bing.net/th?id=OIP.DhgB5v6koG3naKrT4pDIMQHaJQ&pid=Api&P=0&h=180" },
          { "name": "Veg Noodles", "price": 90, "image": "https://tse2.mm.bing.net/th?id=OIP.6gCeaI8CI5CSPMoEnNtW7gHaE7&pid=Api&P=0&h=180" },
          { "name": "Chilli Garlic Noodles", "price": 100, "image": "https://www.whiskaffair.com/wp-content/uploads/2020/02/Chilli-Garlic-Noodles-2-1.jpg" },
          { "name": "Maharashtrian Thali", "price": 150, "image": "https://tse1.mm.bing.net/th?id=OIP.RFhnSLEPSppWqxXmHq6AaAHaEn&pid=Api&P=0&h=180" },
          { "name": "Gulab Jamun", "price": 40, "image": "https://tse1.mm.bing.net/th?id=OIP.jHVOWwSFJmKm4WYjoOIS0QHaFk&pid=Api&P=0&h=180" },
          { "name": "Butter Scotch", "price": 150, "image": "https://tse1.mm.bing.net/th?id=OIP.OQU8y_7GNqFlFCd6-4LWyQHaGA&pid=Api&P=0&h=180" }
        ]
      },
      "nonVeg": {
        "breakfast": [
          { "name": "Egg Dosa", "price": 200, "image": "https://tse4.mm.bing.net/th?id=OIP.Y_vXEbPCwtl_Z8vrjBZGqAHaFg&pid=Api&P=0&h=180" },
          { "name": "Chicken Keema Dosa", "price": 300, "image": "https://tse2.mm.bing.net/th?id=OIP.GwWKrpOb2XDP5UhtV7ctgQHaHa&pid=Api&P=0&h=180" },
          { "name": "Chicken Cheese Omlete", "price": 300, "image": "https://tse2.mm.bing.net/th?id=OIP.0wAsZcltNgyxrCe9eNfW8AHaLH&pid=Api&P=0&h=180" },
          { "name": "Poori Chicken", "price": 120, "image": "https://tse3.mm.bing.net/th?id=OIP.TLx2zfPsPmqtSdcGNG6ORwHaFP&pid=Api&P=0&h=180" },
          { "name": "Egg Curry with Chapathi", "price": 120, "image": "https://tse2.mm.bing.net/th?id=OIP.gt0PCxGbyWt5vm0xZxcIMQHaHa&pid=Api&P=0&h=180" },
          { "name": "Chicken Poha", "price": 120, "image": "https://tse1.mm.bing.net/th?id=OIP.D4RExCI1TNeKkhvR90TwyAHaGg&pid=Api&P=0&h=180" },
          { "name": "Double Egg Dosa", "price": 120, "image": "https://tse1.mm.bing.net/th?id=OIP.VMh_uNqoB-GGNyFGn34boAHaE7&pid=Api&P=0&h=180" },
          { "name": "Idly Mutton Paya", "price": 120, "image": "https://tse3.mm.bing.net/th?id=OIP.5D9se28Umg3WFItsZ9n_8gHaLG&pid=Api&P=0&h=180" },
          { "name": "Egg Idiyapam", "price": 120, "image": "https://tse3.mm.bing.net/th?id=OIP.BFsqo1Er2bKxa-10lUyUaQHaE8&pid=Api&P=0&h=180" }
        ],
        "lunch": [
          { "name": "Chicken Biryani", "price": 250, "image": "https://tse3.mm.bing.net/th?id=OIP.niF8N9Z3Hl8u7-rC6c5rHQHaHa&pid=Api&P=0&h=180" },
          { "name": "Mutton Biryani", "price": 400, "image": "https://tse2.mm.bing.net/th?id=OIP.pK3hTwN_FIWMmNhocPG9tgHaHa&pid=Api&P=0&h=180" },
          { "name": "Butter Chicken", "price": 280, "image": "https://tse2.mm.bing.net/th?id=OIP.ymVxogdnrcb3OdXrKMwEcgHaGP&pid=Api&P=0&h=180" },
          { "name": "Fish Biryani", "price": 80, "image": "https://tse3.mm.bing.net/th?id=OIP.Y9dF150pyuX6gLxA7eZOQwHaEK&pid=Api&P=0&h=180" },
          { "name": "Dragon Chicken", "price": 80, "image": "https://tse1.mm.bing.net/th?id=OIP.ybXlZi7lwbeQ_BVECFQoZQHaE8&pid=Api&P=0&h=180" },
          { "name": "Prawns Biryani", "price": 250, "image": "https://www.archanaskitchen.com/images/archanaskitchen/1-Author/Shaheen_Ali/CHETTINAD_STYLE_PRAWN_BIRYANI.jpg" },
          { "name": "Chicken Wings", "price": 250, "image": "https://tse1.mm.bing.net/th?id=OIP.-ztsUQI-GTLFZ9D9BujFmAHaE8&pid=Api&P=0&h=180" },
          { "name": "Mutton Rogan Josh", "price": 500, "image": "https://tse2.mm.bing.net/th?id=OIP.sZJMuDAqLZXtns2bssLZ0QHaE8&pid=Api&P=0&h=180" },
          { "name": "Apolo Fish", "price": 90, "image": "https://tse3.mm.bing.net/th?id=OIP.WrC5kpz_b4gZsHhh9kaDgwHaHa&pid=Api&P=0&h=180" }
        ],
        "snacks": [
          { "name": "Chicken Lollipop", "price": 220, "image": "https://tse4.mm.bing.net/th?id=OIP.XD_h36tpTHaEQGnkAfLOAAHaHa&pid=Api&P=0&h=180" },
          { "name": "Chicken Shawarma", "price": 150, "image": "https://tse4.mm.bing.net/th?id=OIP.ETWaZrpkjtqRlbSFYqZgcQHaHa&pid=Api&P=0&h=180" },
          { "name": "Egg Puff", "price": 100, "image": "https://tse4.mm.bing.net/th?id=OIP.Tvv5sweqo-HpRzVSx49SzwHaE8&pid=Api&P=0&h=180" },
          { "name": "Chicken Popcorn", "price": 329, "image": "https://tse1.mm.bing.net/th?id=OIP.7SfH2jqoSZhquVM2jjcICAHaE8&pid=Api&P=0&h=180" },
          { "name": "Tandoori Chicken Box", "price": 330, "image": "https://tse3.mm.bing.net/th?id=OIP.TGy1CUTtrcxofXlTcotmMgHaHa&pid=Api&P=0&h=180" },
          { "name": "Chicken Crunch Meal", "price": 475, "image": "https://tse4.mm.bing.net/th?id=OIP.ZZxrRdfzY6eXl1-rJr1eDAHaF3&pid=Api&P=0&h=180" },
          { "name": "Spicy Chicken Burger", "price": 200, "image": "https://tse3.mm.bing.net/th?id=OIP.YIuhrX1MRLO3leVlkdjkYwAAAA&pid=Api&P=0&h=180" },
          { "name": "Super 6s Chicken Bucket", "price": 799, "image": "https://tse3.mm.bing.net/th?id=OIP.apGD5oFdZSuVOjlkcZUwtQHaHa&pid=Api&P=0&h=180" },
          { "name": "Chicken Puff", "price": 90, "image": "https://tse2.mm.bing.net/th?id=OIP.OCbHJVkGu5-S34JCY3TAyAHaEl&pid=Api&P=0&h=180" }
        ],
        "dinner": [
          { "name": "Grilled Chicken", "price": 300, "image": "https://tse2.mm.bing.net/th?id=OIP.fRed2wxh8swVz3a8Dr0xYgHaE7&pid=Api&P=0&h=180" },
          { "name": "Butter Chicken", "price": 280, "image": "https://tse2.mm.bing.net/th?id=OIP.ymVxogdnrcb3OdXrKMwEcgHaGP&pid=Api&P=0&h=180" },
          { "name": "Chicken Fry Biryani", "price": 300, "image": "https://tse1.mm.bing.net/th?id=OIP.ajiyfSbb7bL5vxwd4lxTyQHaEK&pid=Api&P=0&h=180" },
          { "name": "Natukodi Fry Biryani", "price": 350, "image": "https://tse2.mm.bing.net/th?id=OIP.ocFoCz2IqG_8BvSbNAOztQHaEK&pid=Api&P=0&h=180" },
          { "name": "Barbeque Chicken Tikka", "price": 120, "image": "https://tse4.mm.bing.net/th?id=OIP.lNDX2J8uBQeVpxzbJnrXrQHaEK&pid=Api&P=0&h=180" },
          { "name": "Leg Piece Fry", "price": 175, "image": "https://tse2.mm.bing.net/th?id=OIP.sPpJ8HyMaqza1E1PRTLSPAHaE8&pid=Api&P=0&h=180" },
          { "name": "Kaju Chicken Dry", "price": 170, "image": "https://tse2.mm.bing.net/th?id=OIP.LTJkpjZrDjCcbsqxbZW_TwHaEK&pid=Api&P=0&h=180" },
          { "name": "Rambha Chicken Curry", "price": 250, "image": "https://tse3.mm.bing.net/th?id=OIP.faCu_sis2pT3ZpVlPopO4AHaKC&pid=Api&P=0&h=180" },
          { "name": "Fish Kabab", "price": 100, "image": "https://tse4.mm.bing.net/th?id=OIP.3rGhz0eOCVGax6bdhdtmuwHaEK&pid=Api&P=0&h=180" }
        ]
      }
    };

  
  // Table number submission
  function submitTable() {
    let tableNumberInput = document.getElementById("tableInput").value;
    if (tableNumberInput && !isNaN(tableNumberInput) && tableNumberInput > 0 && tableNumberInput <= 20) {
      tableNumber = tableNumberInput;
      document.getElementById("tableNumberPage").style.display = "none";
    } else {
      alert("Please enter a valid table number (1-20).");
    }
  }
  
  // Form step validation and navigation
  function validateStep1() {
    const name = document.getElementById('name').value;
    const email = document.getElementById('email').value;
    const phone = document.getElementById('phone').value;
    
    if (!name || !email || !phone) {
      alert('Please fill in all fields');
      return;
    }
    
    if (!email.includes('@') || !email.includes('.')) {
      alert('Please enter a valid email address');
      return;
    }
    
    if (phone.length < 10 || isNaN(phone)) {
      alert('Please enter a valid phone number');
      return;
    }
    
    userName = name;
    userEmail = email;
    userPhone = phone;
    
    nextStep(2);
  }
  
  function nextStep(step) {
    document.getElementById(`step${currentStep}`).classList.remove('active');
    document.getElementById(`step${step}`).classList.add('active');
    currentStep = step;
  
    if (step === 3) loadCategories();
    if (step === 4) loadRestaurants();
    if (step === 5) loadMenu();
    if (step === 8) showOrderSummary();
  }
  
  function prevStep() {
    if (currentStep > 1) {
      document.getElementById(`step${currentStep}`).classList.remove('active');
      document.getElementById(`step${currentStep - 1}`).classList.add('active');
      currentStep--;
    }
  }
  
  // Preference and category selection
  function selectPreference(preference) {
    userPreference = preference;
    nextStep(3);
  }
  
  function selectCategory(category) {
    selectedCategory = category;
    nextStep(4);
  }
  
  // Loading dynamic content
  function loadCategories() {
    const categoryList = document.getElementById('categoryList');
    categoryList.innerHTML = '';
    const categories = Object.keys(restaurants[userPreference]);
    categories.forEach(category => {
      const div = document.createElement('div');
      div.className = 'category';
      div.innerHTML = `<p>${category.charAt(0).toUpperCase() + category.slice(1)}</p>`;
      div.onclick = () => selectCategory(category);
      categoryList.appendChild(div);
    });
  }
  
  function loadRestaurants() {
    const restaurantList = document.getElementById('restaurantList');
    restaurantList.innerHTML = '';
    
    const restaurant = {
      name: `${selectedCategory.charAt(0).toUpperCase() + selectedCategory.slice(1)} Specials`,
      menu: restaurants[userPreference][selectedCategory]
    };
    
    const div = document.createElement('div');
    div.className = 'restaurant';
    div.innerHTML = `
      <img src="${restaurant.menu[0].image}" alt="${restaurant.name}">
      <p>${restaurant.name}</p>
    `;
    div.onclick = () => {
      selectedRestaurant = restaurant;
      nextStep(5);
    };
    restaurantList.appendChild(div);
  }
  
  function loadMenu() {
    const menuSlideshow = document.getElementById('menuSlideshow');
    menuSlideshow.innerHTML = '';
    
    selectedRestaurant.menu.forEach(item => {
      const div = document.createElement('div');
      div.className = 'menu-item';
      div.innerHTML = `
        <img src="${item.image}" alt="${item.name}">
        <p>${item.name}</p>
        <p>₹${item.price}</p>
        <button class="btn-secondary" onclick="addToCart('${item.name}', ${item.price})">Add to Cart</button>
      `;
      menuSlideshow.appendChild(div);
    });
  }
  
  // Cart functionality
  function addToCart(name, price) {
    cart.push({ name, price });
    alert(`${name} added to cart!`);
  }
  
  function updateCartCount() {
    document.getElementById('cartCount').textContent = cart.length;
  }
  
  function showCart() {
  updateCartDisplay();
  document.getElementById('cartModal').style.display = 'block';
}
  
  function closeCart() {
    document.getElementById('cartModal').style.display = 'none';
  }
  
  // Food requirements
  function addRequirement(requirement) {
    const textarea = document.getElementById('specifications');
    if (textarea.value && !textarea.value.endsWith(', ')) {
      textarea.value += ', ';
    }
    textarea.value += requirement;
    requirements = textarea.value.split(', ');
  }
  
  // Payment handling
  function togglePaymentFields() {
    const paymentMethod = document.getElementById("payment").value;
  
    document.querySelectorAll('.paymentDetails').forEach(div => {
      div.style.display = "none";
    });
  
    if (paymentMethod === "creditCard") {
      document.getElementById("creditCardDetails").style.display = "block";
    } else if (paymentMethod === "debitCard") {
      document.getElementById("debitCardDetails").style.display = "block";
    } else if (paymentMethod === "googlePay") {
      document.getElementById("googlePayDetails").style.display = "block";
    } else if (paymentMethod === "paytm") {
      document.getElementById("paytmDetails").style.display = "block";
    } else if (paymentMethod === "phonePe") {
      document.getElementById("phonePeDetails").style.display = "block";
    } else if (paymentMethod === "scanner") {
      document.getElementById("scannerDetails").style.display = "block";
    } else if (paymentMethod === "netBanking") {
      document.getElementById("netBankingDetails").style.display = "block";
    } else if (paymentMethod === "upiId") {
      document.getElementById("upiIdDetails").style.display = "block";
    }
  }
  
  function processPayment() {
    if (paymentCompleted) {
      nextStep(8);
      return;
    }
    
    const paymentMethod = document.getElementById("payment").value;
    if (!paymentMethod) {
      alert("Please select a payment method");
      return;
    }
    
    // Validate payment details based on method
    if (paymentMethod === "creditCard") {
      const cardNumber = document.getElementById("cardNumber").value;
      const expiry = document.getElementById("expiry").value;
      const cvv = document.getElementById("cvv").value;
      
      if (!cardNumber || !expiry || !cvv) {
        alert("Please fill in all credit card details");
        return;
      }
    } else if (paymentMethod === "debitCard") {
      const cardNumber = document.getElementById("debitCardNumber").value;
      const expiry = document.getElementById("debitExpiry").value;
      const cvv = document.getElementById("debitCvv").value;
      
      if (!cardNumber || !expiry || !cvv) {
        alert("Please fill in all debit card details");
        return;
      }
    }
    
    document.getElementById('spinner').style.display = 'block';
    
    setTimeout(() => {
      document.getElementById('spinner').style.display = 'none';
      paymentCompleted = true;
      sendOrderEmail();
      nextStep(8);
    }, 2000);
  }
  function sendOrderToAdmin() {
  let total = 0;
  let orderItems = cart.map(item => {
    total += item.price * (item.quantity || 1);
    return `${item.name} (${item.quantity || 1}) - ₹${item.price * (item.quantity || 1)}`;
  }).join('\n');
  
  const requirementsText = document.getElementById('specifications').value || 'None';
  const paymentMethod = document.getElementById('payment').value;
  
  const templateParams = {
    to_name: "Admin", // This will be your name
    to_email: "23kb1a3064@nbkrist.org", // Your email address
    from_name: userName,
    table_number: tableNumber,
    order_items: orderItems,
    total_price: total,
    requirements: requirementsText,
    payment_method: paymentMethod,
    itemcategory_name: selectedRestaurant.name,
    customer_email: userEmail,
    customer_phone: userPhone
  };
  
  // Show loading spinner
  document.getElementById('spinner').style.display = 'block';
  
  emailjs.send('service_pg1h5l9', 'template_ynijmkq', templateParams)
    .then(function(response) {
      document.getElementById('spinner').style.display = 'none';
      alert('Order details have been sent to the restaurant!');
      console.log('SUCCESS!', response.status, response.text);
    }, function(error) {
      document.getElementById('spinner').style.display = 'none';
      alert('Failed to send order details. Please try again.');
      console.log('FAILED...', error);
    });
} 
  function sendOrderEmail() {
    let total = 0;
let orderItems = cart.map(item => {
  total += item.price * item.quantity;
  return `${item.name} (${item.quantity}) - ₹${item.price * item.quantity}`;
}).join('\n');
    
    const requirementsText = document.getElementById('specifications').value || 'None';
    const paymentMethod = document.getElementById('payment').value;
    
    const templateParams = {
      to_name: userName,
      to_email: userEmail,
      table_number: tableNumber,
      order_items: orderItems,
      total_price: total,
      requirements: requirementsText,
      payment_method: paymentMethod,
      itemcategory_name: selectedRestaurant.name
    };
    console.log("Sending email with params:", templateParams);
    emailjs.send('service_pg1h5l9', 'template_ynijmkq', templateParams)
      .then(function(response) {
        console.log('SUCCESS!', response.status, response.text);
      }, function(error) {
        console.log('FAILED...', error);
      });
  }
  
  // Order summary and details
  function showOrderSummary() {
    const orderSummary = document.getElementById('orderSummary');
    
    let total = 0;
let orderItems = '';
cart.forEach(item => {
  orderItems += `<li>${item.name} (${item.quantity}) - ₹${item.price * item.quantity}</li>`;
  total += item.price * item.quantity;
});
  
    orderSummary.innerHTML = `
      <div class="success-message">
        <h3>Successfully Done!</h3>
        <p>Welcome back, ${userName}! Your order has been placed.</p>
      </div>
      <h3>Order Summary</h3>
      <p><strong>Table Number:</strong> ${tableNumber}</p>
      <p><strong>Name:</strong> ${userName}</p>
      <p><strong>Email:</strong> ${userEmail}</p>
      <p><strong>Phone:</strong> ${userPhone}</p>
      <div style="background: #f8f9fa; padding: 30px; border-radius: 15px; margin: 20px 0;">
        <h3>Order Items</h3>
        <ul>${orderItems}</ul>
        <hr style="border-top: 2px solid #eee;">
        <p style="font-weight: bold; font-size: 36px;">Total: ₹${total}</p>
      </div>
      <div style="margin: 20px 0;">
        <p><strong>Special Instructions:</strong> ${document.getElementById('specifications').value || 'None'}</p>
        <p><strong>Payment Method:</strong> ${document.getElementById('payment').value}</p>
        <p><strong>Item Category:</strong> ${selectedRestaurant.name}</p>
      </div>
      <div class="alert alert-success">
        <p>A confirmation has been sent to ${userEmail}</p>
      </div>
    `;
  }
  
  function showOrderDetails() {
    const modal = document.getElementById('orderDetailsModal');
    const modalContent = document.getElementById('modalOrderDetails');
    
    let total = 0;
let orderItems = '';
cart.forEach(item => {
  orderItems += `<li>${item.name} (${item.quantity}) - ₹${item.price * item.quantity}</li>`;
  total += item.price * item.quantity;
});
    
    modalContent.innerHTML = `
      <h3>Complete Order Details</h3>
      <p><strong>Order Number:</strong> #${Math.floor(100000 + Math.random() * 900000)}</p>
      <p><strong>Table Number:</strong> ${tableNumber}</p>
      <p><strong>Customer Name:</strong> ${userName}</p>
      <p><strong>Email:</strong> ${userEmail}</p>
      <p><strong>Phone:</strong> ${userPhone}</p>
      <p><strong>Item Category:</strong> ${selectedRestaurant.name}</p>
      <p><strong>Order Items:</strong></p>
      <ul>${orderItems}</ul>
      <p><strong>Total Amount:</strong> ₹${total}</p>
      <p><strong>Special Requirements:</strong> ${document.getElementById('specifications').value || 'None'}</p>
      <p><strong>Payment Method:</strong> ${document.getElementById('payment').value}</p>
      <p><strong>Order Date:</strong> ${new Date().toLocaleString()}</p>
      <div class="email-notice">
        <p>A copy of this order has been sent to your email address.</p>
        <p>Please check your inbox (and spam folder) for the confirmation.</p>
      </div>
    `;
    
    modal.style.display = 'block';
  }
  
  function closeModal() {
    document.getElementById('orderDetailsModal').style.display = 'none';
  }
  
  // Restart order
  function restartOrder() {
    currentStep = 1;
    userPreference = '';
    selectedCategory = '';
    selectedRestaurant = null;
    cart = [];
    requirements = [];
    paymentCompleted = false;
    
    document.getElementById('name').value = '';
    document.getElementById('email').value = '';
    document.getElementById('phone').value = '';
    document.getElementById('specifications').value = '';
    document.getElementById('payment').value = '';
    
    document.querySelectorAll('.form-step').forEach(step => {
      step.classList.remove('active');
    });
    document.getElementById('step1').classList.add('active');
    
    window.scrollTo({ top: 0, behavior: 'smooth' });
  }
  
  // Initialize payment fields on page load
  window.onload = function() {
    togglePaymentFields();
  };
  
  // Close modals when clicking outside
  window.onclick = function(event) {
    const orderModal = document.getElementById('orderDetailsModal');
    const cartModal = document.getElementById('cartModal');
    if (event.target == orderModal) {
      orderModal.style.display = 'none';
    }
    if (event.target == cartModal) {
      cartModal.style.display = 'none';
    }
  };
  </script>
  <script>
    // Enhanced cart functions
function addToCart(name, price) {
  // Check if item already exists in cart
  const existingItem = cart.find(item => item.name === name);
  if (existingItem) {
    existingItem.quantity = (existingItem.quantity || 1) + 1;
  } else {
    cart.push({ name, price, quantity: 1 });
  }
  updateCartCount();
  showToast(`${name} added to cart!`);
}

function removeFromCart(index) {
  cart.splice(index, 1);
  updateCartDisplay();
  updateCartCount();
}

function updateCartDisplay() {
  const cartItems = document.getElementById('cartItems');
  let total = 0;
  
  if (cart.length === 0) {
    cartItems.innerHTML = '<p>Your cart is empty</p>';
  } else {
    cartItems.innerHTML = '<ul style="list-style: none; padding: 0;">' + 
      cart.map((item, index) => {
        total += item.price * item.quantity;
        return `
          <li style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; padding: 10px; background: #f8f9fa; border-radius: 5px;">
            <div>
              <span style="font-weight: bold;">${item.name}</span>
              <div style="display: flex; align-items: center; margin-top: 5px;">
                <button onclick="updateQuantity(${index}, -1)" style="padding: 5px 10px; margin: 0 5px;">-</button>
                <span>${item.quantity}</span>
                <button onclick="updateQuantity(${index}, 1)" style="padding: 5px 10px; margin: 0 5px;">+</button>
                <span style="margin-left: 10px;">₹${item.price * item.quantity}</span>
              </div>
            </div>
            <button onclick="removeFromCart(${index})" style="color: red; background: none; border: none; cursor: pointer;">×</button>
          </li>
        `;
      }).join('') + '</ul>';
  }
  
  document.getElementById('cartTotal').textContent = total;
}

function updateQuantity(index, change) {
  cart[index].quantity += change;
  
  // Remove item if quantity reaches 0
  if (cart[index].quantity <= 0) {
    cart.splice(index, 1);
  }
  
  updateCartDisplay();
  updateCartCount();
}

function updateCartCount() {
  const count = cart.reduce((total, item) => total + (item.quantity || 1), 0);
  document.getElementById('cartCount').textContent = count;
}

function showToast(message) {
  const toast = document.createElement('div');
  toast.textContent = message;
  toast.style.position = 'fixed';
  toast.style.bottom = '20px';
  toast.style.left = '50%';
  toast.style.transform = 'translateX(-50%)';
  toast.style.backgroundColor = '#28a745';
  toast.style.color = 'white';
  toast.style.padding = '10px 20px';
  toast.style.borderRadius = '5px';
  toast.style.zIndex = '1000';
  document.body.appendChild(toast);
  
  setTimeout(() => {
    toast.remove();
  }, 2000);
}

function proceedToCheckout() {
  closeCart();
  nextStep(6); // Proceed to requirements step
}
function closeTab() {
  // Try to close the tab (may not work in all browsers due to security restrictions)
  window.close();
  
  // Fallback for browsers that block window.close()
  if (!window.closed) {
    alert("To complete your exit, please close this tab manually.");
    // Alternatively, you could redirect to another page
    // window.location.href = "about:blank";
  }
}
  </script>
</body>
</html>
